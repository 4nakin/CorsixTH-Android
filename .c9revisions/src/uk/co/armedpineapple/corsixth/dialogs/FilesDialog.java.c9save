{"ts":1354184620570,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"/*\n *   Copyright (C) 2012 Alan Woolley\n *   \n *   See LICENSE.TXT for full license\n */\npackage uk.co.armedpineapple.corsixth.dialogs;\n\nimport java.io.File;\nimport java.io.FilenameFilter;\nimport java.io.IOException;\nimport java.util.Collections;\nimport java.util.List;\nimport java.util.Locale;\n\nimport uk.co.armedpineapple.corsixth.Files;\nimport uk.co.armedpineapple.corsixth.Files.FileDetails;\nimport uk.co.armedpineapple.corsixth.R;\nimport uk.co.armedpineapple.corsixth.SDLActivity;\nimport android.app.Dialog;\nimport android.content.Context;\nimport android.view.View;\nimport android.widget.AdapterView;\nimport android.widget.Button;\nimport android.widget.ListView;\nimport android.widget.AdapterView.OnItemClickListener;\n\npublic abstract class FilesDialog extends Dialog implements OnItemClickListener {\n\n\tprivate String\t\t\t\t\t\t\tsavePath;\n\tprivate Button\t\t\t\t\t\t\tcancelButton;\n\n\tprotected List<FileDetails>\tsaves;\n\tprotected FilesAdapter\t\t\tarrayAdapter;\n\tprotected ListView\t\t\t\t\tsavesList;\n\tprotected SDLActivity\t\t\t\tctx;\n\n\tprivate boolean\t\t\t\t\t\t\thasNewButton;\n\n\t@Override\n\tpublic void onBackPressed() {\n\t\tsuper.onBackPressed();\n\t\tSDLActivity.cthGameSpeed(ctx.config.getGameSpeed());\n\t}\n\n\tpublic FilesDialog(SDLActivity context, String path, int layout,\n\t\t\tboolean hasNewButton) {\n\t\tsuper(context);\n\n\t\tthis.ctx = context;\n\t\tthis.hasNewButton = hasNewButton;\n\n\t\tsavePath = path;\n\t\tsetContentView(layout);\n\t\tsavesList = (ListView) findViewById(R.id.filesList);\n\t\tsavesList.setOnItemClickListener(this);\n\t\tcancelButton = (Button) findViewById(R.id.dismissDialogButton);\n\n\t\tcancelButton.setOnClickListener(new View.OnClickListener() {\n\n\t\t\t@Override\n\t\t\tpublic void onClick(View v) {\n\t\t\t\tInteger speed;\n\t\t\t\tif ((speed = ctx.config.getGameSpeed()) != null) {\n\t\t\t\t\tSDLActivity.cthGameSpeed(speed);\n\t\t\t\t}\n\t\t\t\tdismiss();\n\t\t\t}\n\n\t\t});\n\n\t}\n\n\tpublic void updateSaves(final Context ctx) throws IOException {\n\t\tsaves = Files.listFilesInDirectory(savePath, new FilenameFilter() {\n\n\t\t\t@Override\n\t\t\tpublic boolean accept(File dir, String filename) {\n\t\t\t\treturn filename.toLowerCase(Locale.US).endsWith(\".sav\")\n\t\t\t\t\t\t&& !filename.toLowerCase(Locale.US).equals(\n\t\t\t\t\t\t\t\tctx.getString(R.string.quicksave_name))\n\t\t\t\t\t\t&& !filename.toLowerCase(Locale.US).equals(\n\t\t\t\t\t\t\t\tctx.getString(R.string.autosave_name));\n\t\t\t}\n\t\t});\n\n\t\t// Sort the saves to be most recent first.\n\n\t\tCollections.sort(saves, Collections.reverseOrder());\n\n\t\tarrayAdapter = new FilesAdapter(ctx, saves, hasNewButton);\n\t\tsavesList.setAdapter(arrayAdapter);\n\n\t}\n\n\t@Override\n\tpublic void onItemClick(AdapterView<?> parent, View view, int position,\n\t\t\tlong id) {\n\n\t\tif (hasNewButton && position == 0) {\n\t\t\tonNewClicked();\n\t\t} else {\n\t\t\tonSelectedFile(saves.get(hasNewButton ? position - 1 : position)\n\t\t\t\t\t.getFileName());\n\t\t}\n\t}\n\n\tpublic abstract void onSelectedFile(String file);\n\n\tpublic void onNewClicked() {\n\n\t}\n\n}\n"]],"start1":0,"start2":0,"length1":0,"length2":2854}]],"length":2854}
{"contributors":[],"silentsave":false,"ts":1354184624126,"patch":[[{"diffs":[[0,"Locale;\n"],[-1,"\n"],[0,"import u"]],"start1":286,"start2":286,"length1":17,"length2":16}]],"length":2853,"saved":false}
{"ts":1354184642460,"patch":[[{"diffs":[[0,"etails>\t"],[1,"            "],[0,"saves;\n\t"]],"start1":895,"start2":895,"length1":16,"length2":28},{"diffs":[[0,"apter\t\t\t"],[1,"        "],[0,"arrayAda"]],"start1":940,"start2":940,"length1":16,"length2":24},{"diffs":[[0,"ListView\t\t\t\t"],[1,"    "],[0,"\tsavesList;\n"]],"start1":981,"start2":981,"length1":24,"length2":28},{"diffs":[[0,"vity\t\t\t\t"],[1,"    "],[0,"ctx;\n\n\tp"]],"start1":1027,"start2":1027,"length1":16,"length2":20}]],"length":2881,"saved":false}
{"ts":1354184670872,"patch":[[{"diffs":[[0,"ssed();\n"],[1,"        // Unpause the game if the back button is pressed\n"],[0,"\t\tSDLAct"]],"start1":1142,"start2":1142,"length1":16,"length2":74}]],"length":2939,"saved":false}
{"ts":1354185046315,"patch":[[{"diffs":[[0,"       /"],[-1,"/"],[1,"*"],[0," Unpause"]],"start1":1151,"start2":1151,"length1":17,"length2":17},{"diffs":[[0,"ssed"],[-1,"\n\t\tSDLActivity.cthGameSpeed(ctx.config.getGameSpeed());"],[1,". Note that\n        it is possible for getGameSpeed() to return null if the \n        game is on the main menu screen, for example. */\n        \n\t\tInteger speed;\n\t\tif ((speed = ctx.config.getGameSpeed()) != null) {\n\t\t\tSDLActivity.cthGameSpeed(speed);\n\t\t}"],[0,"\n\t}\n"]],"start1":1203,"start2":1203,"length1":63,"length2":260},{"diffs":[[0,"stView) find"],[1,"please"],[0,"ViewById(R.i"]],"start1":1697,"start2":1697,"length1":24,"length2":30},{"diffs":[[0," speed;\n"],[-1,""],[0,"\t\t\t\tif ("]],"start1":1971,"start2":1971,"length1":16,"length2":16},{"diffs":[[0," != null) {\n"],[1,"                    // Unpause the game if the back button is pressed\n"],[0,"\t\t\t\t\tSDLActi"]],"start1":2022,"start2":2022,"length1":24,"length2":94}]],"length":3212,"saved":false}
{"ts":1354185069737,"patch":[[{"diffs":[[0,"the game if the "],[-1,"back"],[1,"cancel"],[0," button is press"]],"start1":2065,"start2":2065,"length1":36,"length2":38}]],"length":3214,"saved":false}
{"ts":1354185095765,"patch":[[{"diffs":[[0,"filename) {\n"],[1,"                /* Filter out any files that don't end with .sav, or are the\n                quicksave or autosave files */\n                \n"],[0,"\t\t\t\treturn f"]],"start1":2373,"start2":2373,"length1":24,"length2":165}]],"length":3355,"saved":false}
{"ts":1354185098205,"patch":[[{"diffs":[[0,"filename) {\n"],[1,"                \n"],[0,"            "]],"start1":2373,"start2":2373,"length1":24,"length2":41}]],"length":3372,"saved":false}
{"ts":1354185114238,"patch":[[{"diffs":[[0,"er());\n\n"],[1,"        // Update the adapter\n        \n"],[0,"\t\tarrayA"]],"start1":2905,"start2":2905,"length1":16,"length2":55}]],"length":3411,"saved":false}
{"ts":1354186153747,"patch":[[{"diffs":[[0,"ssed();\n"],[1,"        \n"],[0,"        "]],"start1":1142,"start2":1142,"length1":16,"length2":25}]],"length":3420,"saved":false}
